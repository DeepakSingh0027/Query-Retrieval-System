const fs = require('fs');
const path = require('path');
const Pdf = require('./lib/pdf-parse.js'); // Ensure this file exists and exports a function

module.exports = Pdf;

const isDebugMode = !module.parent;

if (isDebugMode) {
    const PDF_FILE = path.join(__dirname, 'test', 'data', '05-versions-space.pdf');

    try {
        const dataBuffer = fs.readFileSync(PDF_FILE);
        Pdf(dataBuffer).then(data => {
            const outputPath = `${PDF_FILE}.txt`;
            fs.writeFileSync(outputPath, data.text, 'utf8');
            console.log(`✅ Text extracted to: ${outputPath}`);
            debugger; // optional for dev debugging
        }).catch(err => {
            console.error('❌ PDF parsing error:', err.message);
            debugger;
        });
    } catch (readErr) {
        console.error('❌ File read error:', readErr.message);
    }
}
