import fs from "fs";
import PDF from "./lib/pdf-parse.js"; // Make sure this file is also ES module-compatible

export default PDF;

// For testing purpose
if (import.meta.url === `file://${process.argv[1]}`) {
  // Use a relative path based on the current module location
  const PDF_FILE = new URL("./test/data/05-versions-space.pdf", import.meta.url);

  try {
    const dataBuffer = fs.readFileSync(PDF_FILE);
    PDF(dataBuffer).then((data) => {
      fs.writeFileSync(`${PDF_FILE}.txt`, data.text, {
        encoding: "utf8",
        flag: "w",
      });
      debugger;
    }).catch((err) => {
      console.error("Error during PDF parsing:", err);
      debugger;
    });
  } catch (err) {
    console.error("File not found or can't be read:", err.message);
  }
}
